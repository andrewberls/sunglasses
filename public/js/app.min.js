var $loading=$(".loading-container"),$result=$(".result-container"),$error=$(".error-container"),$form=$(".city");function clean(a){return a.filter(function(a){return a})}function fail(){$error.slideDown(150)}function build_forecast(a,b){return"<div>Forecast is <span>"+a+"</span>, with a temp of <span>"+b+"</span>.</div>"}function build_result(a,b,c){return"<div class='"+a+"'>"+("affirmative"===a?"Yep!":"negative"===a?"Nope!":"Maybe?")+build_forecast(b,c)+"</div>"}
function done(a){var b="";a=JSON.parse(a);if(!a.need)return fail();var c=clean(a.icon.split(/(mostly|partly)?(cloudy|sunny|clear)/)).join(" ");switch(a.need){case "true":b="affirmative";break;case "false":b="negative";break;default:b="maybe"}$result.append(build_result(b,c,a.temp));$result.slideDown(150)}function submit(){$result.empty();$error.hide();$loading.show();city=$(".city").val();$.post("/sunglasses",{city:city}).done(done).always(function(){$loading.hide()});return!1}$(".submit").click(submit);
$form.keyup(function(a){13===a.keyCode&&submit()});
